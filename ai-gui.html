<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Emotion Recognition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        #chat-container::-webkit-scrollbar { width: 6px; }
        #chat-container::-webkit-scrollbar-track { background: #2d2d2d; }
        #chat-container::-webkit-scrollbar-thumb { background: #6b7280; border-radius: 3px; }
        #chat-container::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        textarea::-webkit-scrollbar { width: 6px; }
        textarea::-webkit-scrollbar-track { background: #2d2d2d; }
        textarea::-webkit-scrollbar-thumb { background: #6b7280; border-radius: 3px; }
        textarea::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        #input-container { position: sticky; bottom: 0; background: #2d2d2d; z-index: 10; }
        .thinking::after { content: '.'; animation: dots 1.5s infinite; }
        @keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60% { content: '...'; } }
        .pill-button { border-radius: 9999px; transition: background-color 0.3s, color 0.3s; }
        #sentences { background: transparent !important; }
		.message-content { overflow-wrap: break-word; }
    </style>
</head>
<body class="bg-[#1a1a1a] font-sans text-gray-300">
    <div class="flex flex-col h-screen max-w-2xl mx-auto">
        <header id="header" class="bg-[#1a1a1a] p-4 hidden">
            <h1 class="text-xl font-bold text-center text-gray-300" style="user-select: none;">AI Emotion Recognition</h1>
        </header>
        <div id="cover" class="flex-1 flex flex-col items-center justify-center p-4">
            <h1 class="text-2xl font-bold text-gray-300 mb-4" style="user-select: none;">AI Emotion Recognition</h1>
            <a href="https://wzj-901.github.io/recode.html" class="flex items-center bg-[#2d2d2d] text-gray-300 px-4 py-2 pill-button">
                <span>今日已识别<span id="visit-times-cover">0</span>次</span>
                <svg class="w-5 h-5 ml-2 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
            </a>
        </div>
        <div id="chat-container" class="flex-1 overflow-y-auto p-4 space-y-4 hidden"></div>
        <div id="input-container" class="p-4 bg-[#2d2d2d]">
            <div class="flex flex-col space-y-2">
                <textarea id="sentences" rows="3" maxlength="999" class="flex-1 p-2 text-gray-300 focus:outline-none focus:ring-0 resize-none placeholder-gray-500" placeholder="Input English text..."></textarea>
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-2">
                        <button id="inprivate" class="bg-[#2d2d2d] text-gray-500 px-4 py-1 pill-button border border-gray-500" style="user-select: none;">inprivate</button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span id="char-count" class="text-sm text-gray-500"></span>
                        <button id="btn" onclick="addSentence()" class="bg-[#e07b39] text-white w-10 h-10 rounded-full flex items-center justify-center disabled:bg-gray-600 disabled:cursor-not-allowed disabled:pointer-events-none">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="popup" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-[#2d2d2d] p-4 rounded-lg max-w-sm w-full">
            <p id="popup-message" class="text-gray-300"></p>
            <button onclick="closePopup()" class="mt-4 bg-[#e07b39] text-white px-4 py-2 rounded-lg hover:bg-[#b35920]">OK</button>
        </div>
    </div>
    <script>setInterval("document.querySelector('textarea').value=document.querySelector('textarea').value.replace(/wangsiguang/i,'').replace(/sggg/i,'').replace(/wangzijian/i,'').replace(/wzj/i,'').replace(/gaoyuanlin/i,'').replace(/gyl/i,'')" ,500)
    const s='https://bflqilyverogmjwsxlys.supabase.co',A='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJmbHFpbHl2ZXJvZ21qd3N4bHlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE5Njc1MDQsImV4cCI6MjA1NzU0MzUwNH0.73o9lq_RkWzgW5QENCTBMkZkITw-Dn_eSVc7dfFp6zU',{createClient}=supabase,supabaseClient=createClient(s,A);async function F(_0xd64aee){try{const {data:_0x22a82d,error:_0x19ff28}=await supabaseClient['from']('ai1')['select']('answer')['eq']('identify',_0xd64aee)['single']();if(_0x19ff28)return console['error']('Error\x20fetching\x20data:',_0x19ff28),'';return console['log']('Fetched\x20messages:',_0x22a82d),_0x22a82d;}catch(_0x3e1aec){return console['error']('Unexpected\x20error:',_0x3e1aec),'';}}async function I(_0x544e25){try{const {data:_0x5832dc,error:_0x3abeaf}=await supabaseClient['from']('ai1')['insert'](_0x544e25)['select']();if(_0x3abeaf)return console['error']('Error\x20inserting\x20data:',_0x3abeaf),null;return console['log']('Inserted\x20data:',_0x5832dc[0x0]),_0x5832dc[0x0];}catch(_0x588800){return console['error']('Unexpected\x20error:',_0x588800),null;}}async function U(_0x3d55f0,_0x13867c,_0x4c1217,_0x7c2a3f,_0x5e522a){try{const {data:_0x1e0751,error:_0x174294}=await supabaseClient['from'](_0x3d55f0)['update']({[_0x7c2a3f]:_0x5e522a})['eq'](_0x13867c,_0x4c1217)['select'](_0x7c2a3f)['single']();if(_0x174294)return console['error']('Error\x20updating\x20data:',_0x174294),null;return console['log']('Updated\x20data:',_0x1e0751),_0x1e0751;}catch(_0x2685b2){return console['error']('Unexpected\x20error:',_0x2685b2),null;}}async function G(){try{const {count:_0x41ebff,error:_0x16e6ea}=await supabaseClient['from']('ai1')['select']('*',{'count':'exact','head':!![]});if(_0x16e6ea)return console['error']('Error\x20fetching\x20table\x20count:',_0x16e6ea),appendMessage('Failed\x20to\x20fetch\x20visit\x20count.\x20Please\x20try\x20again\x20later.','ai',null,![],!![]),null;return console['log']('Table\x20has\x20'+_0x41ebff+'\x20records'),_0x41ebff;}catch(_0x47cf45){return console['error']('Unexpected\x20error:',_0x47cf45),appendMessage('Failed\x20to\x20fetch\x20visit\x20count.\x20Please\x20try\x20again\x20later.','ai',null,![],!![]),null;}}function isStrictASCII(_0x1b714f){return/^[\x00-\x7F]*$/['test'](_0x1b714f);}let updating=![],waiting_download=![],download_id=null,send_times=0x0,last_message_id=0x0,hasSentFirstMessage=![],inprivateActive=![];function appendMessage(_0x55d1ba,_0x5208e1,_0x54fd41=null,_0x47e73f=![],_0x5c7aeb=![]){const _0x58fe81=document['getElementById']('chat-container'),_0xa6523b=document['createElement']('div');_0xa6523b['id']=_0x54fd41?'message-'+_0x54fd41:'message-'+ ++last_message_id,_0xa6523b['className']='chat-message\x20'+(_0x5208e1==='user'?'user-message\x20flex\x20justify-end':'ai-message');const _0x3f7add=document['createElement']('div');_0x3f7add['className']='p-3\x20rounded-lg\x20max-w-[80%]\x20message-content\x20'+(_0x5208e1==='user'?'bg-[#e07b39]\x20text-white':'bg-[#2d2d2d]\x20text-gray-300')+'\x20'+(_0x5208e1==='ai'&&_0x55d1ba['includes']('thinking')?'thinking':''),_0x3f7add['textContent']=_0x55d1ba;if(_0x47e73f){const _0x77acbb=document['createElement']('span');_0x77acbb['className']='text-gray-500\x20text-sm\x20ml-2',_0x77acbb['textContent']='<inprivate>',_0x3f7add['appendChild'](_0x77acbb);}_0xa6523b['appendChild'](_0x3f7add);if(_0x5c7aeb){const _0xe29d9b=document['createElement']('div');_0xe29d9b['className']='flex\x20space-x-2\x20mt-1',_0xe29d9b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22copy-'+last_message_id+'\x22\x20onclick=\x22copyText(\x27'+_0x55d1ba+'\x27,\x20'+last_message_id+')\x22\x20class=\x22text-gray-500\x20hover:text-[#e07b39]\x22><svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M8\x2016H6a2\x202\x200\x2001-2-2V6a2\x202\x200\x20012-2h8a2\x202\x200\x20012\x202v2m-6\x2012h8a2\x202\x200\x20002-2v-8a2\x202\x200\x2000-2-2h-8a2\x202\x200\x2000-2\x202v8a2\x202\x200\x20002\x202z\x22></path></svg></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22like-'+last_message_id+'\x22\x20onclick=\x22toggleLike('+last_message_id+')\x22\x20class=\x22text-gray-500\x20hover:text-[#e07b39]\x22><svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M5\x2015l7-7\x207\x207\x22></path></svg></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22dislike-'+last_message_id+'\x22\x20onclick=\x22toggleDislike('+last_message_id+')\x22\x20class=\x22text-gray-500\x20hover:text-[#e07b39]\x22><svg\x20class=\x22w-4\x20h-4\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M19\x209l-7\x207-7-7\x22></path></svg></button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xa6523b['appendChild'](_0xe29d9b);}_0x58fe81['appendChild'](_0xa6523b),_0x58fe81['scrollTop']=_0x58fe81['scrollHeight'];}function showPopup(_0x28c1f8){document['getElementById']('popup-message')['textContent']=_0x28c1f8,document['getElementById']('popup')['classList']['remove']('hidden');}function closePopup(){document['getElementById']('popup')['classList']['add']('hidden');}function copyText(_0xccd0a,_0x588c7c){navigator['clipboard']['writeText'](_0xccd0a);const _0x18d331=document['getElementById']('copy-'+_0x588c7c);_0x18d331['innerHTML']='<svg\x20class=\x22w-4\x20h-4\x20text-[#e07b39]\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20stroke-width=\x222\x22\x20d=\x22M5\x2013l4\x204L19\x207\x22></path></svg>';}function toggleLike(_0x2251b4){const _0x197f56=document['getElementById']('like-'+_0x2251b4),_0x2a7833=document['getElementById']('dislike-'+_0x2251b4),_0x4f819b=_0x197f56['classList']['contains']('text-[#e07b39]');_0x197f56['classList']['toggle']('text-[#e07b39]',!_0x4f819b);if(!_0x4f819b)_0x2a7833['classList']['remove']('text-[#e07b39]');}function toggleDislike(_0x27e997){const _0x578004=document['getElementById']('like-'+_0x27e997),_0x1173f5=document['getElementById']('dislike-'+_0x27e997),_0x66bb1a=_0x1173f5['classList']['contains']('text-[#e07b39]');_0x1173f5['classList']['toggle']('text-[#e07b39]',!_0x66bb1a);if(!_0x66bb1a)_0x578004['classList']['remove']('text-[#e07b39]');}function updateCharCount(){const _0x37bfb3=document['getElementById']('sentences'),_0x54d4e9=document['getElementById']('char-count'),_0x1d704b=document['getElementById']('btn'),_0x4c72a1=_0x37bfb3['value']['length'];if(!isStrictASCII(_0x37bfb3['value']))_0x54d4e9['textContent']='请输入英文字符',_0x1d704b['classList']['add']('disabled:bg-gray-600','disabled:cursor-not-allowed','disabled:pointer-events-none'),_0x1d704b['disabled']=!![];else{if(_0x4c72a1===0x0)_0x54d4e9['textContent']='',_0x1d704b['classList']['add']('disabled:bg-gray-600','disabled:cursor-not-allowed','disabled:pointer-events-none'),_0x1d704b['disabled']=!![];else _0x4c72a1<=0xf?(_0x54d4e9['textContent']='字数不足',_0x1d704b['classList']['add']('disabled:bg-gray-600','disabled:cursor-not-allowed','disabled:pointer-events-none'),_0x1d704b['disabled']=!![]):(_0x54d4e9['textContent']=_0x4c72a1+'\x20/\x20999',!updating&&(_0x1d704b['classList']['remove']('disabled:bg-gray-600','disabled:cursor-not-allowed','disabled:pointer-events-none'),_0x1d704b['disabled']=![]));}}function addSentence(){const _0x1094ad=document['getElementById']('sentences'),_0x105cbf=document['getElementById']('btn'),_0x2d305b=_0x1094ad['value'];if(_0x2d305b['length']>0x3e7){showPopup('您的文本\x22'+_0x2d305b['slice'](0x0,0x14)+'...\x22超过999字符限制！');return;}if(!isStrictASCII(_0x2d305b)){const _0xbf3641=_0x2d305b['match'](/[^\x00-\x7F]/g)||[];showPopup('您的文本\x22'+_0x2d305b['slice'](0x0,0x14)+'...\x22含有非法字符\x22'+_0xbf3641['join'](',\x20')+'\x22！');return;}_0x2d305b['length']>0xf&&!updating?(!hasSentFirstMessage&&(hasSentFirstMessage=!![],document['getElementById']('cover')['classList']['add']('hidden'),document['getElementById']('header')['classList']['remove']('hidden'),document['getElementById']('chat-container')['classList']['remove']('hidden')),_0x105cbf['disabled']=!![],_0x105cbf['classList']['add']('disabled:bg-gray-600','disabled:cursor-not-allowed','disabled:pointer-events-none'),updating=!![],waiting_download=!![],send_times=0x0,download_id=('00000000'+Math['floor'](Math['random']()*0x989680))['slice'](-0x8),appendMessage(_0x2d305b,'user',download_id,inprivateActive),I({'identify':download_id,'sentences':_0x2d305b}),appendMessage('thinking...','ai'),setTimeout(fetching,0x7d0),_0x1094ad['value']='',updateCharCount()):appendMessage(updating?'正在等待上一个请求的响应':'请输入15字符以上的纯英文语句','ai',null,![],!![]);}function fetching(){F(download_id)['then'](async _0x360cee=>{const _0x13df80=_0x360cee?.['answer'];send_times===0x0&&!hasSentFirstMessage&&counting(![]);send_times++;if(_0x13df80&&_0x13df80!=='NULL'){inprivateActive&&await U('ai1','identify',download_id,'sentences',document['getElementById']('message-'+download_id)['querySelector']('.chat-message.user-message\x20div')['textContent']+'\x20<inprivate>');const _0x2cae94=document['querySelector']('.thinking');if(_0x2cae94)_0x2cae94['remove']();appendMessage('识别成功','ai'),appendMessage(_0x13df80,'ai',null,![],!![]),updating=![],waiting_download=![],download_id=null;}else{if(send_times<0x3)console['log']('waiting...'),setTimeout(fetching,0x7d0);else{console['log']('timeout!');const _0x477c00=document['querySelector']('.thinking');if(_0x477c00)_0x477c00['remove']();appendMessage('The\x20server\x20is\x20busy,\x20please\x20try\x20again\x20later','ai',null,![],!![]),updating=![],waiting_download=![],download_id=null;}}});}function counting(_0x4f7cae){G()['then'](_0x46bf3a=>{_0x46bf3a?document['getElementById']('visit-times-cover')['textContent']=_0x46bf3a:console['log']('counting\x20error!');if(_0x4f7cae&&!hasSentFirstMessage)setTimeout(()=>counting(!![]),0x3a98);});}document['getElementById']('sentences')['addEventListener']('input',updateCharCount),document['getElementById']('inprivate')['addEventListener']('click',()=>{inprivateActive=!inprivateActive;const _0xc82cfa=document['getElementById']('inprivate');_0xc82cfa['classList']['toggle']('bg-[#000000]'),_0xc82cfa['classList']['toggle']('text-gray-300'),_0xc82cfa['classList']['toggle']('border-gray-500');}),updateCharCount(),counting(!![]);    </script>
</body>
</html>