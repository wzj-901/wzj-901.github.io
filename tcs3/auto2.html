<html>
<head><meta charset="UTF-8"><title>tcs</title></head>
<style>
html{
	background-color:rgb(245,245,245);
}
#main{
	width:200px;
	margin-top:20px;
	background-color:white;
	border:solid 10px rgb(200,200,200);
	position:fixed;
	border-radius:20px;
	overflow:hidden;
}
#point{
	z-index:1000;
	position:fixed;
	background-color:rgba(200,200,200,0.4);
	opacity:0.7;
	padding:10px;
	margin:40px 0 0 10px;
	border-radius:10px;
}
#point:hover{
	background-color:rgba(200,200,200,0.4);
	opacity:1;
}
#xshow,#yshow{
	position:absolute !important;
	left:0px;
	top:0px;
	z-index:10 !important;
	border:solid 1px rgb(220,220,220) !important;
	background-color:rgba(0,0,0,0) !important;
}
#s1head{
	position:absolute !important;
	left:0px;
	top:0px;
	height:18px !important;
	width:18px !important;
	z-index:20 !important;
	margin:1px !important;
	border:0px !important;
	box-shadow: 0 0 40px #FFF;
	background-color:rgb(255,170,100) !important;
}
#s1point{
	position:absolute !important;
	left:0px;
	top:0px;
	height:100% !important;
	width:100% !important;
	z-index:-10 !important;
	margin:10px 30px !important;
	border:0px !important;
	font-family:fantasy;
	font-size:200px;
	color:rgba(0,0,0,0.1);
	transition:1s;
	background-color:rgba(0,0,0,0) !important;
	
}
#xshow{
	height:18px !important;
	width:100% !important;
}
#yshow{
	width:18px !important;
	height:100% !important;
}
#main>div{
	overflow:hidden;
	position:relative;
}
#main>div>div{
	float:left;
	position:relative;
	background-color:rgba(0,0,0,0);
	width:18px;
	height:18px;
	border:1px solid rgb(245,245,240);
}
#main>div>div:hover{
	background-color:red !important;
}
</style>
<body>
<div id="main">
<div id="s1point">00</div>
<div id="xshow"></div><div id="yshow"></div>
<div id="s1head"></div>
</div>
<div id="point"><p class="pta">长度：</p><p class="ptb" id="pt1">0</p><p class="pta">得分：</p><p class="ptb" id="pt2">0</p><p class="pta">步数：</p><p class="ptb" id="pt3">0</p><p class="pta">生命：</p><p class="ptb" id="pt4">0</p></div>
<script>
	//格数
	var x=15
	var y=15
	//属性
	var own1='id="ax1by1"'
	var dx=20
	var dy=20
	var mx=Math.floor(x/2)
	var my=Math.floor(y/2)
	
	var s1do1=true
	var s1do2=true
	var s1do3=""
	var s1do4=""
	
	var stop1=0
	
	var temp0
	var temp1
	var temp2
	var temp3
	var temp4
	var temp5
	var temp6
	var temp7
	var temp8
	var temp9
	var temp10
	
	function pform(b,x0,y0){
		form[x0-1][y0-1]=b;
		pdiv(b,x0,y0)
	}
	function gform(x0,y0){
		return form[x0-1][y0-1]
	}
	function pdiv(b,x0,y0){
		b=b*1
		temp4=true;
		temp5="white";
		switch(b){
			case 0:temp4=true;temp5="rgba(0,0,0,0)";break;
			case 1:temp4=true;temp5="rgb(80,80,80)";break;
			case 2:temp4=true;temp5="rgb(255,140,60)";break;
			case 3:temp4=true;temp5="rgb(255,170,100)";break;
			case 4:temp4=true;temp5="rgb(81,212,103)";break;
		}
		if(temp4){
			document.getElementById("a"+x0+"b"+y0).style.cssText+="background-color:"+temp5
		}
	}
	//动作
	function actdiv(a,b,x0,y0){
		switch(b){
		case 1:
				s1do1=true
				s1do2=true
				s1do3=""
				s1do4=""
				switch(a){
					case 0:break;
					case 1:alert("你撞到墙死了");s1lf--;break;
					case 2:
						s1do1=false;
						s1do3="alert('你撞到自己死了');s1lf--;s1arrx.push(s1dx0);s1arry.push(s1dy0);s1num++;pform2(s1num,s1x,s1y);s1rgb.push(0);pform0(gform0(s1x,s1y)+1,s1x,s1y)"
						break;
					case 3:break;
					case 4:f1();console.log(f1x+"  "+f1y);autonumb=true;pform(0,s1x,s1y);stop1++;s1l++;break;
				}
				if(s1do1){
					//操作数组
					s1arrx.push(s1dx0)
					s1arry.push(s1dy0)
					s1num++;
					pform2(s1num,s1x,s1y)
					s1rgb.push(gform(s1x,s1y))
				}
				eval(s1do3)
				if(s1do2){
					s2()
					pform(2,s1x,s1y)
					focuss1(s1x,s1y)
					s1point()
					s1stp++;
					s1pt0++;
					leftdiv()
					if(autonumb==true){auto();autonumb=false}
					setTimeout("s1()",200)
				}
				eval(s1do4)
				break;
		}
	}
	
	//食物
	function f1(){
		f1x=Math.round(Math.random()*(x-1)+1)
		f1y=Math.round(Math.random()*(y-1)+1)
		if(gform(f1x,f1y)==0){
			pform(4,f1x,f1y)
			focus(f1x,f1y)
			s1pt+=7
			if(s1pt0<s1pt1+x+y){s1pt+=3}
			if(s1pt0<s1pt1+(x+y)/3){s1pt+=3}
			if(s1pt0<s1pt1+5){s1pt+=3}
			s1pt0=0
			s1pt1=Math.abs(f1x-s1x)+Math.abs(f1y-s1y)
		}else{f1()}
	}
	//突出显示
	function focus(x0,y0){
		document.getElementById("xshow").style.top=dy*y0-dy;
		document.getElementById("yshow").style.left=dx*x0-dx;
	}
	function focuss1(x0,y0){
		document.getElementById("s1head").style.top=dy*y0-dy;
		document.getElementById("s1head").style.left=dx*x0-dx;
	}
	function s1point(){
		if(s1l<10){temp8="0"+s1l}else{temp8=s1l}
		document.getElementById("s1point").innerHTML=temp8;
	}
	function leftdiv(){
		temp8=(Math.floor(s1stp/10))*10;
		if(temp8==0){
		temp8=s1stp
		}
		if(temp8==s1stp){
			s1pt+=3
		}
		if((Math.floor(s1stp/30))*30==s1stp&&s1stp>9){
			temp1=Math.round(Math.random())
			temp2=Math.round(Math.random())
			temp3=Math.round(Math.random())
			if(temp1==1&&temp2==1&&temp3==1){temp1=0;temp2=0;temp3=0;}
			document.getElementById("s1point").style.color="rgba("+temp1*255+","+temp2*255+","+temp3*255+",0.1)";
		}
		
		document.getElementById("pt4").style.color="green";
		if(s1lf<1){
			document.getElementById("pt4").style.color="black";
		}
		if(s1lf<-5){
			document.getElementById("pt4").style.color="red";
		}
		document.getElementById("pt3").style.color="black";
		if(temp8>699){
			document.getElementById("pt3").style.color="green";
		}
		document.getElementById("pt2").style.color="black";
		if(s1pt>699){
			document.getElementById("pt2").style.color="green";
		}
		document.getElementById("pt1").style.color="black";
		if(s1l>30){
			document.getElementById("pt1").style.color="green";
		}
		
		document.getElementById("pt1").innerHTML=s1l;
		document.getElementById("pt2").innerHTML=s1pt;
		document.getElementById("pt3").innerHTML=temp8;
		document.getElementById("pt4").innerHTML=s1lf;
	}
	
	
	
	//定义表格x*y
	//0:空
	//1:边框
	//2:蛇1
	//3:蛇1头
	//4:食物
	temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="0,";}temp2="["+temp2+"0]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form="+temp3);
	//打印表格x*y
	function print(){
		for(var temp0=1;temp0<y+1;temp0++){
			for(var temp1=1;temp1<x+1;temp1++){
				pdiv(gform(temp1,temp0),temp1,temp0)
			}
		}
	}
	
	
	//辅助表格0
	temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="0,";}temp2="["+temp2+"0]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form0="+temp3);
	function pform0(b,x0,y0){
		form0[x0-1][y0-1]=b;
	}
	function gform0(x0,y0){
		return form0[x0-1][y0-1]
	}
	
	
	//辅助表格1
	//temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="-1,";}temp2="["+temp2+"-1]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form1="+temp3);
	function cform1(){temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="-1,";}temp2="["+temp2+"-1]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("form1="+temp3);}
	function pform1(b,x0,y0){
		form1[x0-1][y0-1]=b;
	}
	function gform1(x0,y0){
		return form1[x0-1][y0-1]
	}
	
	
	//辅助表格3
	//temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="-1,";}temp2="["+temp2+"-1]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form1="+temp3);
	function cform3(){temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="-1,";}temp2="["+temp2+"-1]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("form3="+temp3);}
	function pform3(b,x0,y0){
		form3[x0-1][y0-1]=b;
	}
	function gform3(x0,y0){
		return form3[x0-1][y0-1]
	}
	
	
	//辅助表格2
	temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="-1,";}temp2="["+temp2+"-1]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form2="+temp3);
	function pform2(b,x0,y0){
		form2[x0-1][y0-1]=b;
	}
	function gform2(x0,y0){
		return form2[x0-1][y0-1]
	}
	
	
	//蛇1头
	var s1x=mx-1;
	var s1y=my;
	var s1dx=1;
	var s1dy=0;
	var s1dx2=1;
	var s1dy2=0;
	var s1arrx=new Array();
	var s1arry=new Array();
	var s1rgb=new Array();
	var s1num=0;
	var autonumb=false;
	var autonumb0=true;
	var autonum;
	var autoform3=false;
	
	var s1l=5;
	var s1pt=1;
	var s1pt0=0;
	var s1pt1=0;
	var s1stp=0;
	var s1lf=1;
	
	function s1(){
		autogo()
		s1dx2=s1dx;
		s1dy2=s1dy;
		s1x+=s1dx;
		s1y+=s1dy;
		s1dx0=s1dx;
		s1dy0=s1dy;
		//超出
		if(s1x>x){
			s1x=1
			s1dx0=1-x;
		}
		if(s1x<1){
			s1x=x
			s1dx0=x-1;
		}
		if(s1y>y){
			s1y=1
			s1dy0=1-y;
		}
		if(s1y<1){
			s1y=y
			s1dy0=y-1;
		}
		actdiv(gform(s1x,s1y),1,s1x,s1y)
	}
	//蛇1尾
	var s2x=mx-s1l-1;
	var s2y=my;
	var s2dx=1;
	var s2dy=0;
	function s2(){
		if(stop1==0){
			if(s1l>s1num-1){
				s2x+=s2dx;
				s2y+=s2dy;
				temp6=0;
			}else{
				if(autonumb==false&&autonumb0==true){autonumb=true;autonumb0=false}
				
				s2x+=s1arrx[s1num-s1l-1];
				s2y+=s1arry[s1num-s1l-1];
				temp6=s1rgb[s1num-s1l-1];
				if(gform0(s2x,s2y)!=0){temp6=2;pform0(gform0(s2x,s2y)-1,s2x,s2y)}
			}
			
			if(s2x>0&&s2y>0&&s2x<x+1&&s2y<y+1){
				pform(temp6,s2x,s2y)
			}
		}else{
			stop1--;
		}
	}
	
	//绘制边框
	function pborder(){
		for(var temp0=1;temp0<y+1;temp0++){
			pform(1,1,temp0)
			pform(1,x,temp0)
		}
		for(var temp1=1;temp1<x+1;temp1++){
			pform(1,temp1,1)
			pform(1,temp1,y)
		}
	}
	
	
	
	/*
	在表格1，pform1(b,x0,y0)，gform1(x0,y0)
	队列autox[],autoy[]
	处理点：比较get x,y +1和周围点（符合要求）大小，小于则赋值过去并加入队列并增加长度auto1
	
	初始化：auto1=0 autox=[] autoy=[]
	归0：auto1=0
	重复
		for 0~auto1-1
			处理点（autox[0],autoy[0]）
			
			autox,autoy删除第一个
	直到长度为auto1=0
	打印
	
	*/
	//自动
	var auto1=0 
	var autox=[]
	var autoy=[]
	var auto2=0 
	var auto2x=[]
	var auto2y=[]
	
	function auto(){
		auto1=1
		autox=[s1x]
		autoy=[s1y]
		cform1();
		pform1(0,s1x,s1y)
		do{
			autodiv(autox[0],autoy[0])
			autox.shift()
			autoy.shift()
			auto1--;
			
		}while(auto1>0)
		//枚举结束
		//alert(form1)
		auto2f()
	}
	function auto2f(){
		auto2=1
		auto2x=[f1x]
		auto2y=[f1y]
		cform3();
		if(gform1(f1x,f1y)==-1){alert("错误，找不到路径")}
		pform3(gform1(f1x,f1y),f1x,f1y);
		autoform3=true
		do{
			auto2div(auto2x[0],auto2y[0])
			auto2x.shift()
			auto2y.shift()
			auto2--;
			
		}while(auto2>0)
		//枚举结束
		//alert(form3)
	}
	
	function autodiv(x,y){
		autonum=gform1(x,y)+1
		autodiv0(autonum,x,crty(y+1))
		autodiv0(autonum,x,crty(y-1))
		autodiv0(autonum,crtx(x-1),y)
		autodiv0(autonum,crtx(x+1),y)
	}
	function auto2div(x,y){
		auto2num=gform1(x,y)-1
		auto2div0(auto2num,x,crty(y+1))
		auto2div0(auto2num,x,crty(y-1))
		auto2div0(auto2num,crtx(x-1),y)
		auto2div0(auto2num,crtx(x+1),y)
	}
	function crtx(a){return ((a-1)%x+x)%x+1}
	function crty(a){return ((a-1)%y+y)%y+1}
	function autodiv0(a,x,y){
		if((gform(x,y)==0||(x==s1x&&y==s1y)||gform(x,y)==4)||(gform(x,y)==2&&s1num+a>s1l+gform2(x,y))){
			if(a<gform1(x,y)||gform1(x,y)==-1){
				pform1(a,x,y);
				autox.push(x);
				autoy.push(y);
				auto1++;
			}
		}
	}
	function auto2div0(a,x,y){
		if(a==gform1(x,y)&&gform1(x,y)!=-1){
			pform3(gform1(x,y),x,y);
			auto2x.push(x);
			auto2y.push(y);
			auto2++;
		}
	}
	function autogo(){
		if(autoform3==true){
			if(gform3(crtx(s1x+s1dx),crty(s1y+s1dy))!=gform3(s1x,s1y)+1){
				if(s1dx==0){
					if(gform3(crtx(s1x+1),s1y)==gform3(s1x,s1y)+1){s1dx=1;s1dy=0}
					if(gform3(crtx(s1x-1),s1y)==gform3(s1x,s1y)+1){s1dx=-1;s1dy=0}
				}
				if(s1dy==0){
					if(gform3(s1x,crty(s1y+1))==gform3(s1x,s1y)+1){s1dy=1;s1dx=0}
					if(gform3(s1x,crty(s1y-1))==gform3(s1x,s1y)+1){s1dy=-1;s1dx=0}
				}
				
			}
		}
	}
	
	
	
	function pborder(){
		for(var temp0=1;temp0<y+1;temp0++){
			pform(1,1,temp0)
			pform(1,x,temp0)
		}
		for(var temp1=1;temp1<x+1;temp1++){
			pform(1,temp1,1)
			pform(1,temp1,y)
		}
	}

	window.onload=function(){
		function change(x,y,mode){}
		
		temp3=""
		for(var temp0=1;temp0<y+1;temp0++){
			temp2=""
			for(var temp1=1;temp1<x+1;temp1++){
				temp2+="<d"+"iv "+own1.replace("x1",temp1).replace("y1",temp0)+"></di"+"v>";
			}
			temp3+="<d"+"iv class='main1'>"+temp2+"</di"+"v>";
		}
		document.getElementById("main").innerHTML+=temp3;
		document.getElementById("main").style.width=dx*x+"px";
		document.getElementById("main").style.left="calc(50% - "+(dx*x/2+40)+"px)";
		
		
		
		
		pborder()
		
		pform(2,mx-4,my)
		pform(2,mx-3,my)
		pform(2,mx-2,my)
		pform(2,mx-1,my)
		f1()
		s1()
		//alert()
	}
	document.onkeydown=function(event){
		var e = event || window.event || arguments.callee.caller.arguments[0];
		if((e && e.keyCode==38)||(e && e.keyCode==87)){//上
			if(s1dx2){
				s1dx=0;
				s1dy=-1;
			}
		}
		if((e && e.keyCode==37)||(e && e.keyCode==65)){//左
			if(s1dy2){
				s1dx=-1;
				s1dy=0;
			}
		}
		if((e && e.keyCode==40)||(e && e.keyCode==83)){//下
			if(s1dx2){
				s1dx=0;
				s1dy=1;
			}
		}
		if((e && e.keyCode==39)||(e && e.keyCode==68)){//右
			if(s1dy2){
				s1dx=1;
				s1dy=0;
			}
		}
		if(e && e.keyCode==80){//暂停
			alert("你已暂停\n\n点击取消以继续")
		}if(e && e.keyCode==82){//重玩
			location.reload()
		}
	}; 
</script>
</body></html>