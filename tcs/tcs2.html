<html>
<head><meta charset="UTF-8"><title>tcs</title></head>
<style>
html{
	background-color:rgb(245,245,245);
}
#main{
	width:200px;
	margin:20px 100px;
	background-color:rgb(200,200,200);
	border:solid 10px rgb(200,200,200);
	position:fixed;
	border-radius:20px;
}
#main>div{
	overflow:hidden;
	position:relative;
}
#main>div>div{
	float:left;
	position:relative;
	background-color:white;
	width:20px;
	height:20px;
}
#main>div>div:hover{
	background-color:red !important;
}
</style>
<body>
<div id="main"></div>
<script>
	//格数
	var x=31
	var y=19
	//属性
	var own1='id="ax1by1"'
	var dx=20
	var dy=20
	var mx=Math.floor(x/2)
	var my=Math.floor(y/2)
	
	var s1do1=true
	var s1do2=true
	var s1do3=""
	var s1do4=""
	
	var stop1=0
	
	var temp0
	var temp1
	var temp2
	var temp3
	var temp4
	var temp5
	var temp6
	var temp7
	var temp8
	var temp9
	var temp10
	
	function pform(b,x0,y0){
		form[x0-1][y0-1]=b;
	}
	function gform(x0,y0){
		return form[x0-1][y0-1]
	}
	function pdiv(b,x0,y0){
		b=b*1
		temp4=true;
		temp5="white";
		switch(b){
			case 0:temp4=true;temp5="white";break;
			case 1:temp4=true;temp5="rgb(80,80,80)";break;
			case 2:temp4=true;temp5="rgb(255,140,60)";break;
			case 3:temp4=true;temp5="rgb(255,150,80)";break;
			case 4:temp4=true;temp5="rgb(81,212,103)";break;
		}
		if(temp4){
			document.getElementById("a"+x0+"b"+y0).style.cssText+="background-color:"+temp5
		}
	}
	//动作
	function actdiv(a,b,x0,y0){
		switch(b){
		case 1:
				s1do1=true
				s1do2=true
				s1do3=""
				s1do4=""
				switch(a){
					case 0:break;
					case 1:alert("你撞到墙死了");break;
					case 2:
						s1do1=false;
						s1do3="s1arrx.push(s1dx0);s1arry.push(s1dy0);s1num++;s1rgb.push(0);pform0(gform0(s1x,s1y)+1,s1x,s1y)"
						alert("你撞到自己死了")
						break;
					case 3:break;
					case 4:f1();pform(0,s1x,s1y);stop1++;s1l++;break;
				}
				if(s1do1){
					//操作数组
					s1arrx.push(s1dx0)
					s1arry.push(s1dy0)
					s1num++;
					s1rgb.push(gform(s1x,s1y))
				}
				eval(s1do3)
				if(s1do2){
					s2()
					pform(2,s1x,s1y)
					print()
					setTimeout("s1()",200)
				}
				eval(s1do4)
				break;
		}
	}
	function f1(){
		f1x=Math.round(Math.random()*(x-1)+1)
		f1y=Math.round(Math.random()*(y-1)+1)
		if(gform(f1x,f1y)==0){
			pform(4,f1x,f1y)
		}else{f1()}
	}
	//定义表格x*y
	//0:空
	//1:边框
	//2:蛇1
	//3:蛇1头
	//4:食物
	temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="0,";}temp2="["+temp2+"0]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form="+temp3);
	//打印表格x*y
	function print(){
		for(var temp0=1;temp0<y+1;temp0++){
			for(var temp1=1;temp1<x+1;temp1++){
				pdiv(gform(temp1,temp0),temp1,temp0)
			}
		}
	}
	
	
	//辅助表格0
	temp3="";temp2="";for(var temp1=1;temp1<y;temp1++){temp2+="0,";}temp2="["+temp2+"0]";for(var temp0=1;temp0<x;temp0++){temp3+=temp2+",";}temp3="["+temp3+temp2+"]";eval("var form0="+temp3);
	function pform0(b,x0,y0){
		form0[x0-1][y0-1]=b;
	}
	function gform0(x0,y0){
		return form0[x0-1][y0-1]
	}
	
	
	//蛇1头
	var s1x=mx-1;
	var s1y=my;
	var s1dx=1;
	var s1dy=0;
	var s1dx2=1;
	var s1dy2=0;
	var s1arrx=new Array();
	var s1arry=new Array();
	var s1rgb=new Array();
	var s1num=0;
	var s1l=5;
	function s1(){
		s1dx2=s1dx;
		s1dy2=s1dy;
		s1x+=s1dx;
		s1y+=s1dy;
		s1dx0=s1dx;
		s1dy0=s1dy;
		//超出
		if(s1x>x){
			s1x=1
			s1dx0=1-x;
		}
		if(s1x<1){
			s1x=x
			s1dx0=x-1;
		}
		if(s1y>y){
			s1y=1
			s1dy0=1-y;
		}
		if(s1y<1){
			s1y=y
			s1dy0=y-1;
		}
		actdiv(gform(s1x,s1y),1,s1x,s1y)
	}
	//蛇1尾
	var s2x=mx-s1l-1;
	var s2y=my;
	var s2dx=1;
	var s2dy=0;
	function s2(){
		if(stop1==0){
		if(s1l>s1num-1){
			s2x+=s2dx;
			s2y+=s2dy;
		}else{
			s2x+=s1arrx[s1num-s1l-1];
			s2y+=s1arry[s1num-s1l-1];
			temp6=s1rgb[s1num-s1l-1];
			if(gform0(s2x,s2y)!=0){temp6=2;pform0(gform0(s2x,s2y)-1,s2x,s2y)}
		}
		pform(temp6,s2x,s2y)
		}else{
			stop1--;
		}
	}
	
	//绘制边框
	function pborder(){
		for(var temp0=1;temp0<y+1;temp0++){
			pform(1,1,temp0)
			pform(1,x,temp0)
		}
		for(var temp1=1;temp1<x+1;temp1++){
			pform(1,temp1,1)
			pform(1,temp1,y)
		}
	}
	
	window.onload=function(){
		function change(x,y,mode){}
		
		temp3=""
		for(var temp0=1;temp0<y+1;temp0++){
			temp2=""
			for(var temp1=1;temp1<x+1;temp1++){
				temp2+="<d"+"iv "+own1.replace("x1",temp1).replace("y1",temp0)+"></di"+"v>";
			}
			temp3+="<d"+"iv class='main1'>"+temp2+"</di"+"v>";
		}
		document.getElementById("main").innerHTML=temp3;
		document.getElementById("main").style.width=dx*x+"px";
		
		
		
		
		pborder()
		
		pform(2,mx-4,my)
		pform(2,mx-3,my)
		pform(2,mx-2,my)
		pform(2,mx-1,my)
		f1()
		s1()
		//alert()
	}
	document.onkeydown=function(event){
		var e = event || window.event || arguments.callee.caller.arguments[0];
		if((e && e.keyCode==38)||(e && e.keyCode==87)){//上
			if(s1dx2){
				s1dx=0;
				s1dy=-1;
			}
		}
		if((e && e.keyCode==37)||(e && e.keyCode==65)){//左
			if(s1dy2){
				s1dx=-1;
				s1dy=0;
			}
		}
		if((e && e.keyCode==40)||(e && e.keyCode==83)){//下
			if(s1dx2){
				s1dx=0;
				s1dy=1;
			}
		}
		if((e && e.keyCode==39)||(e && e.keyCode==68)){//右
			if(s1dy2){
				s1dx=1;
				s1dy=0;
			}
		}
		if(e && e.keyCode==80){//暂停
			alert("你已暂停\n\n点击取消以继续")
		}if(e && e.keyCode==82){//重玩
			location.reload()
		}
	}; 
</script>
</body></html>